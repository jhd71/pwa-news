<!DOCTYPE html>
<html lang="fr" data-theme="light">
<head>
    <script>
        (function() {
            const savedTheme = localStorage.getItem('theme') || 'rouge';
            document.documentElement.setAttribute('data-theme', savedTheme);
        })();
    </script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Petites annonces locales √† Montceau-les-Mines. Achetez, vendez, √©changez entre voisins.">
    <title>Petites Annonces - Actu&M√©dia</title>
    
    <!-- Fonts et ic√¥nes -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/petites-annonces.css">
</head>
<body>
    <!-- En-t√™te -->
    <header class="app-header">
        <a href="index.html" class="back-button" id="backButton">
    <span class="material-icons">arrow_back</span>
</a>
        <h1 class="site-title">Petites Annonces</h1>
    </header>

    <!-- Contenu principal -->
    <div class="annonces-container">
        <!-- En-t√™te de la page -->
        <div class="annonces-header">
    <h1>üè™ Annonces & √âv√©nements Locaux</h1>
    <p>Petites annonces et √©v√©nements √† Montceau-les-Mines et environs</p>
    
    <div class="header-actions">
        <button class="add-annonce-btn" id="addAnnonceBtn">
            <span class="material-icons">add_shopping_cart</span>
            D√©poser une annonce
        </button>
        <button class="add-event-btn" id="addEventBtn">
            <span class="material-icons">event</span>
            Ajouter un √©v√©nement
        </button>
    </div>
</div>

        <!-- Onglets de navigation -->
<div class="content-tabs">
    <button class="tab-btn active" data-tab="all" id="tabAll">
        <span class="material-icons">apps</span>
        Tout voir
    </button>
    <button class="tab-btn" data-tab="annonces" id="tabAnnonces">
        <span class="material-icons">shopping_cart</span>
        Petites Annonces
    </button>
    <button class="tab-btn" data-tab="evenements" id="tabEvenements">
        <span class="material-icons">event</span>
        √âv√©nements Locaux
    </button>
</div>

<!-- Filtres par cat√©gorie -->
<div class="filters-section" id="filtersSection">
    <div class="filters-row">
        <div class="filter-group" id="annonceFilters">
            <label for="categoryFilter">Cat√©gorie</label>
            <select id="categoryFilter">
                <option value="all-annonces">Toutes les annonces</option>
                <option value="vente">Vente</option>
                <option value="achat">Recherche</option>
                <option value="don">Don</option>
                <option value="echange">√âchange</option>
                <option value="services">Services</option>
            </select>
        </div>
        
        <div class="filter-group" id="eventFilters" style="display: none;">
            <label for="eventTypeFilter">Type d'√©v√©nement</label>
            <select id="eventTypeFilter">
                <option value="all-events">Tous les √©v√©nements</option>
                <option value="marche">March√© / Brocante</option>
                <option value="concert">Concert / Spectacle</option>
                <option value="sport">Sport / Loisirs</option>
                <option value="fete">F√™te / C√©l√©bration</option>
                <option value="culture">Culture / Exposition</option>
                <option value="solidarite">Solidarit√©</option>
                <option value="autre">Autre</option>
            </select>
        </div>
    </div>
</div>

        <!-- Grille des annonces -->
        <div id="annoncesGrid" class="annonces-grid">
            <div class="loading">
                <span class="material-icons" style="font-size: 48px;">hourglass_empty</span>
                <p>Chargement des annonces...</p>
            </div>
        </div>
    </div>

    <!-- Modal cr√©ation d'annonce -->
    <div id="createModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>D√©poser une annonce</h2>
                <button class="close-modal" id="closeModal">
		<span class="material-icons">close</span>
		</button>
            </div>
            <form id="annonceForm">
                <!-- Type de publication -->
<div class="form-group">
    <label>Type de publication *</label>
    <div class="type-selector">
        <label class="type-option">
            <input type="radio" name="pub_type" value="annonce" checked>
            <span class="type-label">
                <span class="material-icons">shopping_cart</span>
                Petite Annonce
            </span>
        </label>
        <label class="type-option">
            <input type="radio" name="pub_type" value="evenement">
            <span class="type-label">
                <span class="material-icons">event</span>
                √âv√©nement Local
            </span>
        </label>
    </div>
</div>

<!-- Cat√©gories pour annonces -->
<div class="form-group" id="annonceCategory">
    <label for="category">Cat√©gorie *</label>
    <select name="category" id="category">
        <option value="">-- Choisir une cat√©gorie --</option>
        <option value="vente">Vente</option>
        <option value="achat">Recherche</option>
        <option value="don">Don</option>
        <option value="echange">√âchange</option>
        <option value="services">Services</option>
    </select>
</div>

<!-- Type d'√©v√©nement -->
<div class="form-group" id="eventType" style="display: none;">
    <label for="event_category">Type d'√©v√©nement *</label>
    <select name="event_category" id="event_category">
        <option value="">-- Choisir un type --</option>
        <option value="marche">üõçÔ∏è March√© / Brocante</option>
        <option value="concert">üéµ Concert / Spectacle</option>
        <option value="sport">‚öΩ Sport / Loisirs</option>
        <option value="fete">üéâ F√™te / C√©l√©bration</option>
        <option value="culture">üé® Culture / Exposition</option>
        <option value="solidarite">ü§ù Solidarit√©</option>
        <option value="autre">üìå Autre</option>
    </select>
</div>

                <div class="form-group">
                    <label for="title">Titre de l'annonce *</label>
                    <input type="text" name="title" id="title" 
                           placeholder="Ex: V√©lo de ville en bon √©tat" 
                           required maxlength="100">
                    <span class="form-hint">Maximum 100 caract√®res</span>
                </div>

                <div class="form-group">
                    <label for="description">Description *</label>
                    <textarea name="description" id="description" 
                              placeholder="D√©crivez votre annonce en d√©tail..." 
                              required maxlength="1000"></textarea>
                    <span class="form-hint">Maximum 1000 caract√®res</span>
                </div>

				<div class="form-group">
		<label for="annonceImage">Photo (optionnelle)</label>
				<div class="upload-buttons">
        <button type="button" id="captureAnnonceBtn" class="capture-btn">
            <span class="material-icons">camera_alt</span>
            <span>Prendre une photo</span>
        </button>
			<button type="button" id="galleryAnnonceBtn" class="gallery-btn">
				<span class="material-icons">photo_library</span>
				<span>Choisir une image</span>
				</button>
			</div>
				<input type="file" id="annonceImage" accept="image/*" style="display: none;">
				<div id="annoncePreview" class="photo-preview" style="margin-top: 10px;"></div>
			</div>

                <!-- Champs sp√©cifiques aux √©v√©nements -->
<div id="eventFields" style="display: none;">
    <div class="form-group">
        <label for="event_date">Date de l'√©v√©nement *</label>
        <input type="date" name="event_date" id="event_date">
    </div>
    
    <div class="form-group">
        <label for="event_time">Heure de d√©but</label>
        <input type="time" name="event_time" id="event_time">
        <span class="form-hint">Optionnel</span>
    </div>
    
    <div class="form-group">
        <label for="event_end_date">Date de fin (si plusieurs jours)</label>
        <input type="date" name="event_end_date" id="event_end_date">
        <span class="form-hint">Pour les √©v√©nements sur plusieurs jours</span>
    </div>
    
    <div class="form-group">
        <label for="organizer">Organisateur</label>
        <input type="text" name="organizer" id="organizer" 
               placeholder="Nom de l'association, mairie, etc.">
    </div>
</div>

<!-- Champ prix (visible seulement pour annonces) -->
<div class="form-group" id="priceField">
    <label for="price">Prix (optionnel)</label>
    <input type="number" name="price" id="price" 
           placeholder="0.00" min="0" step="0.01">
    <span class="form-hint">Laissez vide si don ou √©change</span>
</div>

                <div class="form-group">
                    <label for="author_name">Votre nom ou pseudo *</label>
                    <input type="text" name="author_name" id="author_name" 
                           placeholder="Comment voulez-vous √™tre identifi√© ?" required>
                </div>

                <div class="form-group">
                    <label for="author_email">Votre email *</label>
                    <input type="email" name="author_email" id="author_email" 
                           placeholder="votre@email.fr" required>
                    <span class="form-hint">Ne sera pas affich√© publiquement</span>
                </div>

                <div class="form-group">
                    <label for="author_phone">T√©l√©phone (optionnel)</label>
                    <input type="tel" name="author_phone" id="author_phone" 
                           placeholder="06 12 34 56 78">
                </div>

                <div class="form-group">
                    <label for="location">Ville *</label>
                    <input type="text" name="location" id="location" 
                           value="Montceau-les-Mines" required>
                </div>

                <button type="submit" class="submit-btn">
                    Publier mon annonce
                </button>
            </form>
        </div>
    </div>

	<div id="detailsModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="modalTitle">Titre de l'annonce</h2>
            <button class="close-modal" id="closeDetailsModal">
		<span class="material-icons">close</span>
	</button>
        </div>
        <div class="modal-body">
            <div id="modalImageContainer">
                </div>
            <div class="modal-details-grid">
                <div class="modal-detail-item">
                    <span class="material-icons">sell</span>
                    <strong id="modalPrice">Prix</strong>
                </div>
                <div class="modal-detail-item">
                    <span class="material-icons">place</span>
                    <strong id="modalLocation">Lieu</strong>
                </div>
            </div>
            <p id="modalDescription">Description de l'annonce...</p>
            <div class="modal-contact">
                <h3>Contacter l'annonceur</h3>
                <p id="modalContactEmail"><span class="material-icons">email</span> </p>
                <p id="modalContactPhone"><span class="material-icons">phone</span> </p>
            </div>
        </div>
    </div>
</div>

    <!-- Navigation du bas -->
    <nav class="bottom-nav">
        <a href="index.html" class="nav-item">
            <span class="material-icons">home</span>
            <span>Accueil</span>
        </a>
        <a href="petites-annonces.html" class="nav-item active">
            <span class="material-icons">store</span>
            <span>Annonces</span>
        </a>
    </nav>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase-client.js"></script>
    <script src="js/annonces-manager.js"></script>
</body>
</html>