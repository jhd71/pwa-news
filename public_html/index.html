<!DOCTYPE html>
<html lang="fr" data-theme="light" data-font-size="normal">
<head>
    <!-- === OPTIMISATION PERFORMANCE : Script critique === -->
    <script>
        // Application immédiate du thème pour éviter le flash
        (function() {
            const savedTheme = localStorage.getItem('theme') || 'rouge';
            document.documentElement.setAttribute('data-theme', savedTheme);
        })();
    </script>

    <!-- === META TAGS ESSENTIELS === -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <!-- === SEO OPTIMISÉ === -->
    <title>Actu&Média Montceau | Actualités locales, météo, info 71300</title>
    <meta name="description" content="Toute l'actualité de Montceau-les-Mines et Saône-et-Loire en temps réel. Infos locales, météo, radio, TV direct, cinéma. Le média local de référence.">
    <meta name="keywords" content="Montceau-les-Mines actualités, news 71300, Le JSL, Saône-et-Loire infos, Montceau aujourd'hui, événements Montceau, cinéma L'Embarcadère, météo Montceau">
    <meta name="author" content="Actu & Média">
    <meta name="copyright" content="Actu & Média 2025">
    <meta name="language" content="fr-FR">
    <meta name="geo.region" content="FR-BFC">
    <meta name="geo.placename" content="Montceau-les-Mines">
    <meta name="geo.position" content="46.6739;4.3629">
    <meta name="ICBM" content="46.6739, 4.3629">
    
    <!-- === ROBOTS ET INDEXATION === -->
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="googlebot" content="index, follow">
    <meta name="bingbot" content="index, follow">
    <meta name="google-site-verification" content="74sCYbSwcWjU7BQ8Mxhboe9IiRzajIbyy6C1hyuAr3U">
    
    <!-- === CANONICAL ET ALTERNATE === -->
    <link rel="canonical" href="https://actuetmedia.fr/">
    <link rel="alternate" href="https://actuetmedia.fr/" hreflang="fr-FR">
    
    <!-- === OPEN GRAPH (Facebook, LinkedIn) === -->
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Actu & Média">
    <meta property="og:locale" content="fr_FR">
    <meta property="og:url" content="https://actuetmedia.fr/">
    <meta property="og:title" content="Actu & Média - L'actualité de Montceau-les-Mines en temps réel">
    <meta property="og:description" content="Toute l'info locale de Montceau-les-Mines et environs : actualités, météo, événements, cinéma, radio et TV en direct.">
    <meta property="og:image" content="https://actuetmedia.fr/images/og-image-1200x630.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="Actu & Média - Le média local de Montceau-les-Mines">
    <meta property="og:image:type" content="image/jpeg">
    
    <!-- === TWITTER CARD === -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@ActuetMedia">
    <meta name="twitter:creator" content="@ActuetMedia">
    <meta name="twitter:url" content="https://actuetmedia.fr/">
    <meta name="twitter:title" content="Actu & Média | Info Montceau-les-Mines">
    <meta name="twitter:description" content="L'actualité de Montceau-les-Mines en temps réel. Info locale, météo, événements.">
    <meta name="twitter:image" content="https://actuetmedia.fr/images/twitter-card-1200x600.jpg">
    <meta name="twitter:image:alt" content="Actu & Média Montceau">
    
    <!-- === PWA & MANIFEST === -->
    <link rel="manifest" href="/manifest.json">
    <meta name="application-name" content="Actu&Média">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#940000">
    <meta name="msapplication-navbutton-color" content="#940000">
    <meta name="msapplication-starturl" content="/">
    <meta name="msapplication-TileColor" content="#940000">
    
    <!-- === APPLE / iOS === -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Actu&Média">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    
    <!-- === FAVICONS ET ICÔNES === -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/images/AM-192-v2.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/images/AM-512-v2.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="192x192" href="/images/AM-192-v2.png">
    <meta name="msapplication-TileImage" content="/images/AM-192-v2.png">
    
    <!-- === PERFORMANCE & PRELOAD === -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    
    <!-- === SÉCURITÉ CSP === -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://formspree.io; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https:; connect-src 'self' https://formspree.io https://*.supabase.co">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
    <meta name="referrer" content="strict-origin-when-cross-origin">
	
	<!-- === SCHEMA.ORG / JSON-LD AMÉLIORÉ === -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Actu & Média",
      "alternateName": "Actu&Média Montceau",
      "url": "https://actuetmedia.fr/",
      "description": "Le média local de référence pour l'actualité de Montceau-les-Mines et la Saône-et-Loire",
      "publisher": {
        "@type": "Organization",
        "name": "Actu & Média",
        "logo": {
          "@type": "ImageObject",
          "url": "https://actuetmedia.fr/images/AM-512-v2.png",
          "width": 512,
          "height": 512
        },
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Montceau-les-Mines",
          "postalCode": "71300",
          "addressRegion": "Saône-et-Loire",
          "addressCountry": "FR"
        }
      },
      "potentialAction": {
        "@type": "SearchAction",
        "target": {
          "@type": "EntryPoint",
          "urlTemplate": "https://actuetmedia.fr/search?q={search_term_string}"
        },
        "query-input": "required name=search_term_string"
      },
      "sameAs": [
        "https://www.facebook.com/actuetmedia",
        "https://x.com/ActuetMedia",
        "https://www.instagram.com/actu_et_media/"
      ]
    }
    </script>
    
    <!-- === LOCAL BUSINESS SCHEMA CORRIGÉ === -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "NewsMediaOrganization",
      "name": "Actu & Média",
      "url": "https://actuetmedia.fr/",
      "logo": "https://actuetmedia.fr/images/AM-512-v2.png",
      "foundingDate": "2024",
      "address": {
        "@type": "PostalAddress",
        "addressLocality": "Montceau-les-Mines",
        "postalCode": "71300",
        "addressRegion": "Saône-et-Loire",
        "addressCountry": "FR"
      },
      "areaServed": {
        "@type": "GeoCircle",
        "geoMidpoint": {
          "@type": "GeoCoordinates",
          "latitude": 46.6739,
          "longitude": 4.3629
        },
        "geoRadius": "20000"
      },
      "contactPoint": {
        "@type": "ContactPoint",
        "contactType": "customer service",
        "email": "contact@actuetmedia.fr",
        "availableLanguage": "French"
      }
    }
    </script>

    <!-- === BREADCRUMB SCHEMA === -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "name": "Accueil",
        "item": "https://actuetmedia.fr/"
      }]
    }
    </script>
    
    <!-- === POLICES GOOGLE FONTS OPTIMISÉES === -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;900&family=Open+Sans:wght@400;500;600;700&family=Roboto:wght@400;500;700&family=Roboto+Condensed:wght@400;700&display=swap" as="style">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;900&family=Open+Sans:wght@400;500;600;700&family=Roboto:wght@400;500;700&family=Roboto+Condensed:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <!-- === BIBLIOTHÈQUES EXTERNES AVEC INTÉGRITÉ === -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" integrity="sha384-sMfJCLCJYLN9eiPVQ2pVBqY8aGXEZ5wMZRPHI7Y9ktulXCXLlV4pJXK7mNgKqXFo" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js" integrity="sha384-sYmT3LnYnDmH0KN6W9pAYoNztX5HkFbpz3j3R4KXv3qJZCK2cNZ7LgYKDX2xVl5t" crossorigin="anonymous" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2" defer></script>
    
    <!-- === FEUILLES DE STYLE LOCALES === -->
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/chat-styles.css">
    <link rel="stylesheet" href="css/news-panel.css">
    <link rel="stylesheet" href="css/widgets.css">
    <link rel="stylesheet" href="css/settings-styles.css">
    <link rel="stylesheet" href="css/chat-ban.css">
    <link rel="stylesheet" href="css/survey-styles.css">
    <link rel="stylesheet" href="css/tile-enhancements.css">
    <link rel="stylesheet" href="css/tv-tiles-fix.css">
    <link rel="stylesheet" href="css/font-settings.css">
    <link rel="stylesheet" href="css/theme-bleuciel.css">
    <link rel="stylesheet" href="css/background-selector.css">
    <link rel="stylesheet" href="css/donation.css">
    <link rel="stylesheet" href="css/news-widget.css">
    <link rel="stylesheet" href="css/cinema-widget.css">
    <link rel="stylesheet" href="css/gallery-styles.css">
    <link rel="stylesheet" href="css/football-widget.css">
    <link rel="stylesheet" href="css/radioPopup.css">
    <link rel="stylesheet" href="css/notepadApp.css">
    <link rel="stylesheet" href="css/todoApp.css">
    
    <!-- === SCRIPT SUPABASE === -->
    <script src="js/supabase-client.js" defer></script>
</head>

<body>
    <!-- === HEADER OPTIMISÉ === -->
    <header class="app-header" role="banner">
        <button type="button" id="menuButton" class="menu-button" aria-label="Ouvrir le menu" aria-expanded="false">
            <span class="material-icons" aria-hidden="true">menu</span>
        </button>
        
        <h1 class="site-title logo-text">Actu & Média</h1>
        
        <button type="button" id="settingsButton" class="settings-button" aria-label="Paramètres">
            <span class="material-icons" aria-hidden="true">settings</span>
        </button>
    </header>

    <!-- === WIDGET MÉTÉO SIDEBAR === -->
    <aside class="weather-sidebar" id="weatherSidebar" role="complementary" aria-label="Météo locale">
        <button class="weather-toggle" title="Masquer la météo" aria-label="Fermer le widget météo">
            <span class="material-icons" aria-hidden="true">close</span>
        </button>
        <div id="weather-widget" aria-live="polite">Chargement...</div>
    </aside>

    <!-- === BOUTONS D'OUTILS === -->
    <div class="floating-tools" role="toolbar" aria-label="Outils rapides">
        <button class="tool-button" onclick="openExpenseManager()" title="Gestionnaire de dépenses familiales" aria-label="Ouvrir le gestionnaire de dépenses">
            <span class="material-icons" aria-hidden="true">euro</span>
        </button>
        <button class="search-button" onclick="window.open('/autour-de-moi.html', '_blank')" title="Autour de moi" aria-label="Rechercher autour de moi">
            <span class="material-icons" aria-hidden="true">near_me</span>
        </button>
    </div>

    <!-- === CARROUSEL D'ACTUALITÉS === -->
    <section class="swiper-container" aria-label="Actualités à la une">
        <div class="swiper">
            <div class="swiper-wrapper" id="swiperWrapper">
                <div class="swiper-slide">
                    <div class="slide-content">
                        <p>Chargement des actualités...</p>
                    </div>
                </div>
            </div>
            <div class="swiper-pagination" role="tablist" aria-label="Pagination des actualités"></div>
            <button class="swiper-button-prev" aria-label="Actualité précédente"></button>
            <button class="swiper-button-next" aria-label="Actualité suivante"></button>
        </div>
    </section>

    <!-- === WIDGETS PRINCIPAUX === -->
    <section class="widgets-row" role="region" aria-label="Widgets principaux">
        <!-- Widget NEWS Actu&Média -->
        <article class="news-widget-container">
            <div class="local-news-widget" id="localNewsWidget" onclick="openLocalNewsPage()" role="button" tabindex="0" aria-label="Ouvrir toutes les actualités">
                <header class="news-widget-header">
                    <button class="submit-news-btn" onclick="event.stopPropagation(); openSubmitModal();" aria-label="Proposer une actualité">
                        <span aria-hidden="true">📝</span>
                        <span>Proposer</span>
                    </button>
                    
                    <div class="header-buttons">
                        <button class="header-btn photos-btn" onclick="event.stopPropagation(); openGalleryPage();" title="Galerie Photos" aria-label="Ouvrir la galerie photos">
                            <span class="material-icons" aria-hidden="true">photo_library</span>
                            Photos
                        </button>
                        <button class="header-btn cinema-btn" onclick="event.stopPropagation(); openCinemaModal();" title="Programme Cinéma" aria-label="Voir le programme cinéma">
                            <span class="material-icons" aria-hidden="true">movie</span>
                            Cinéma
                        </button>
                    </div>
                    
                    <div class="header-widgets">
                        <div class="weather-temp" id="weatherTemp" onclick="event.stopPropagation(); openWeatherDetails();" title="Cliquez pour plus d'infos météo" role="button" tabindex="0">
                            <div class="temp-value" id="tempValue" aria-live="polite">--°</div>
                            <div class="temp-label">Météo</div>
                        </div>
                        
                        <div class="visitors-counter" id="visitorsCounter" title="Visiteurs actuellement connectés">
                            <div class="visitors-count" id="visitorsCount" aria-live="polite">--</div>
                            <div class="visitors-label">En ligne</div>
                        </div>
                        
                        <div class="news-widget-clock" id="newsWidgetClock" onclick="event.stopPropagation(); openTimeWidget();" title="Cliquez pour plus d'infos" role="button" tabindex="0">
                            <time class="clock-time" id="clockTime">--:--</time>
                            <time class="clock-date" id="clockDate">---</time>
                        </div>
                    </div>
                </header>
                
                <div class="news-widget-preview" id="newsWidgetPreview" aria-live="polite">
                    <div class="loading-news">
                        <span class="material-icons spinning" aria-hidden="true">hourglass_empty</span>
                        Chargement des actualités...
                    </div>
                </div>
                
                <footer class="news-widget-footer">
                    <span class="news-widget-tap">👆 Touchez pour lire toutes les actualités</span>
                    <div class="news-widget-count" id="newsWidgetCount" aria-live="polite">0 news</div>
                </footer>
            </div>
        </article>

        <!-- Widget CINÉMA -->
        <article class="cinema-widget-container">
            <div class="cinema-widget" id="cinemaWidget" onclick="openCinemaPage()" role="button" tabindex="0" aria-label="Ouvrir le programme cinéma">
                <header class="cinema-widget-header">
                    <span class="cinema-widget-title">🎬 CINÉMA L'Embarcadère</span>
                    <span class="cinema-widget-badge">Panacéa</span>
                </header>
                
                <div class="cinema-widget-preview" id="cinemaWidgetPreview" aria-live="polite">
                    <div class="loading-cinema">
                        <span class="material-icons spinning" aria-hidden="true">hourglass_empty</span>
                        Chargement du programme...
                    </div>
                </div>
                
                <footer class="cinema-widget-footer">
                    <span class="cinema-widget-tap">👆 Programme complet & réservations</span>
                    <span class="cinema-widget-count" id="cinemaWidgetCount" aria-live="polite">0 films</span>
                </footer>
            </div>
        </article>
    </section>
	
	<!-- === MENU LATÉRAL === -->
    <nav id="sidebar" class="sidebar" role="navigation" aria-label="Menu principal" aria-hidden="true">
        <header class="sidebar-header">
            <h2>Menu</h2>
            <button type="button" class="close-btn" aria-label="Fermer le menu">
                <span class="material-icons" aria-hidden="true">close</span>
            </button>
        </header>
        
        <ul class="menu-list" role="list">
            <li class="menu-item">
                <a href="#" id="bgSelectorBtn" class="menu-link" aria-label="Changer le fond d'écran">
                    <span class="material-icons" aria-hidden="true">wallpaper</span>
                    <span>Fond d'écran</span>
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/contact.html" aria-label="Page de contact">
                    <span class="material-icons" aria-hidden="true">email</span>
                    Contact
                </a>
            </li>
            
            <li class="menu-item">
                <a href="https://www.swisstransfer.com/fr-ch" target="_blank" rel="noopener noreferrer" aria-label="Swiss Transfer - nouvelle fenêtre">
                    <span class="material-icons" aria-hidden="true">upload</span>
                    Swiss Transfer
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/politique-confidentialite" aria-label="Politique de confidentialité">
                    <span class="material-icons" aria-hidden="true">security</span>
                    Confidentialité
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/conditions-utilisation" aria-label="Conditions d'utilisation">
                    <span class="material-icons" aria-hidden="true">description</span>
                    Conditions d'utilisation
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/mentions-legales" aria-label="Mentions légales">
                    <span class="material-icons" aria-hidden="true">gavel</span>
                    Mentions légales
                </a>
            </li>
            
            <li class="menu-item">
                <button id="menuInstall" class="menu-link" aria-label="Installer l'application">
                    <span class="material-icons" aria-hidden="true">download</span>
                    <span>Installer l'application</span>
                </button>
            </li>
        </ul>
        
        <div class="menu-item qr-code-container">
            <h4>Scannez notre QR code</h4>
            <img src="images/qrcode.png" alt="QR Code pour accéder au site" class="sidebar-qr-code" loading="lazy">
        </div>
        
        <footer class="menu-item">
            <div class="copyright-text">
                <span class="material-icons" aria-hidden="true">copyright</span>
                <span><span id="currentYear"></span> Actu & Média</span>
            </div>
        </footer>
    </nav>

    <!-- === MODAL CINÉMA MOBILE === -->
    <dialog class="cinema-mobile-modal" id="cinemaMobileModal" aria-labelledby="cinemaModalTitle" aria-describedby="cinemaModalDesc">
        <div class="cinema-modal-content">
            <header class="cinema-modal-header">
                <h3 id="cinemaModalTitle">🎬 CINÉMA L'Embarcadère</h3>
                <button class="cinema-modal-close" id="cinemaModalClose" aria-label="Fermer">✕</button>
            </header>
            <div id="cinemaModalContent" role="region" aria-label="Contenu du programme cinéma">
                <!-- Le contenu du widget sera copié ici -->
            </div>
            <footer style="text-align: center; margin-top: 15px;">
                <button onclick="window.open('https://www.cinemas-panacea.fr/montceau-embarcadere/horaires/', '_blank')" 
                        class="btn-primary"
                        aria-label="Ouvrir le programme complet dans une nouvelle fenêtre">
                    📅 Programme complet & réservations
                </button>
            </footer>
        </div>
    </dialog>

    <!-- === CONTENU PRINCIPAL === -->
    <main role="main" aria-label="Contenu principal">
        <div id="tileContainer" class="tile-container grid" role="grid" aria-label="Grille des services"></div>
    </main>

    <!-- === TICKER D'ACTUALITÉS === -->
    <aside class="news-ticker" role="marquee" aria-label="Fil d'actualités">
        <div class="ticker-wrapper" id="newsTicker" aria-live="polite">
            <div class="ticker-item">Chargement des actualités...</div>
        </div>
    </aside>

    <!-- === BARRE DE NAVIGATION DU BAS === -->
    <nav class="bottom-nav" role="navigation" aria-label="Navigation secondaire">
        <button class="nav-item" id="darkModeToggle" aria-label="Basculer le mode sombre">
            <span class="material-icons" aria-hidden="true">dark_mode</span>
            <span>Sombre</span>
        </button>
        <button class="nav-item" id="layoutToggle" aria-label="Changer la disposition">
            <span class="material-icons" aria-hidden="true">grid_view</span>
            <span>Vue</span>
        </button>
        <button class="nav-item" id="donateButton" aria-label="Faire un don">
            <span class="material-icons" aria-hidden="true">local_cafe</span>
            <span>Un café ?</span>
        </button>
        <button class="nav-item chat-toggle-btn" id="chatToggleBtn" aria-label="Ouvrir le chat">
            <span class="material-icons" aria-hidden="true">chat</span>
            <span>Chat</span>
            <span class="chat-notification-badge hidden" aria-live="polite">0</span>
        </button>
    </nav>
	
	<!-- === BOUTONS D'ACTIONS === -->
    <section class="button-group" role="group" aria-label="Actions rapides">
        <button id="newsButton" class="news-button" aria-label="Afficher les infos en direct">
            <span class="material-icons" aria-hidden="true">feed</span>
            <span>Infos en direct</span>
        </button>
        <button class="weather-show-btn" id="weatherShowBtn" title="Afficher la météo" aria-label="Réafficher le widget météo">
            <span class="material-icons" aria-hidden="true">cloudy_snowing</span>
        </button>
    </section>

    <!-- === WIDGET LIENS RAPIDES === -->
    <aside class="quick-links-sidebar" id="quickLinksSidebar" role="complementary" aria-label="Liens rapides">
        <button class="quick-links-toggle" title="Masquer les liens rapides" aria-label="Fermer les liens rapides">
            <span class="material-icons" aria-hidden="true">close</span>
        </button>
        <h3>Liens rapides</h3>
        <nav class="links-grid" role="navigation">
            <a href="#" class="quick-link emergency-link" onclick="showEmergencyNumbers(event)" aria-label="Numéros d'urgence">
                <span class="material-icons" aria-hidden="true">phone_in_talk</span>
                <span class="quick-link-label">Urgence</span>
            </a>
            <a href="https://www.montceaulesmines.fr/" class="quick-link" target="_blank" rel="noopener noreferrer" aria-label="Site de la ville de Montceau">
                <span class="material-icons" aria-hidden="true">location_city</span>
                <span>Ville de Montceau</span>
            </a>
            <a href="https://www.inforoute71.fr/" class="quick-link" target="_blank" rel="noopener noreferrer" aria-label="Informations routières">
                <span class="material-icons" aria-hidden="true">directions_car</span>
                <span>Info Routes</span>
            </a>
            <a href="https://www.ter.sncf.com/bourgogne-franche-comte" class="quick-link" target="_blank" rel="noopener noreferrer" aria-label="Horaires des trains TER">
                <span class="material-icons" aria-hidden="true">train</span>
                <span>Horaires TER</span>
            </a>
            <a href="https://www.doctolib.fr/medecin-generaliste/montceau-les-mines" class="quick-link" target="_blank" rel="noopener noreferrer" aria-label="Prendre rendez-vous médecin">
                <span class="material-icons" aria-hidden="true">medical_services</span>
                <span>Médecins</span>
            </a>
            <a href="https://www.impots.gouv.fr/" class="quick-link" target="_blank" rel="noopener noreferrer" aria-label="Site des impôts">
                <span class="material-icons" aria-hidden="true">receipt_long</span>
                <span>Impôts</span>
            </a>
            <a href="https://www.service-public.fr/" class="quick-link" target="_blank" rel="noopener noreferrer" aria-label="Service public">
                <span class="material-icons" aria-hidden="true">public</span>
                <span>Service Public</span>
            </a>
        </nav>
    </aside>

    <!-- === BOUTON RÉAFFICHER LIENS RAPIDES === -->
    <button class="quick-links-show-btn" id="quickLinksShowBtn" title="Afficher les liens rapides" aria-label="Réafficher les liens rapides">
        <span class="material-icons" aria-hidden="true">dashboard_customize</span>
    </button>

    <!-- === PANEL DES ACTUALITÉS === -->
    <aside class="news-panel" id="newsPanel" role="complementary" aria-label="Panel des actualités" aria-hidden="true">
        <header class="panel-header">
            <h3>Actualités en direct</h3>
            <button class="close-panel" aria-label="Fermer le panel">
                <span class="material-icons" aria-hidden="true">close</span>
            </button>
        </header>
        <div class="panel-content" id="newsPanelContent" role="feed" aria-live="polite">
            <!-- Les actualités seront injectées ici -->
        </div>
        <button class="mobile-close-panel" id="mobileClosePanel" aria-label="Fermer le panel">
            <span class="material-icons" aria-hidden="true">keyboard_arrow_down</span>
            <span>Fermer</span>
        </button>
        <button class="refresh-button" id="refreshButton" aria-label="Actualiser les informations">
            <span class="material-icons" aria-hidden="true">refresh</span>
            Actualiser les infos
        </button>
    </aside>

    <!-- === MODAL SONDAGE === -->
    <dialog class="survey-modal" id="surveyModal" aria-labelledby="surveyTitle" aria-describedby="surveyDesc">
        <div class="survey-content">
            <header class="survey-header">
                <h2 id="surveyTitle">Aidez-nous à améliorer Actu&Média</h2>
                <button class="close-survey" id="closeSurvey" aria-label="Fermer le sondage"></button>
            </header>
            
            <form id="surveyQuestions" role="form">
                <!-- Question 1 -->
                <fieldset class="survey-question" data-question="preference">
                    <legend>Quelle rubrique préférez-vous sur Actu&Média ?</legend>
                    <div class="survey-options" role="radiogroup">
                        <label class="survey-option" data-value="actualites">
                            <input type="radio" name="preference" value="actualites" class="sr-only">
                            <div class="survey-option-icon">
                                <span class="material-icons" aria-hidden="true">newspaper</span>
                            </div>
                            <span>Actualités locales</span>
                        </label>
                        <label class="survey-option" data-value="sports">
                            <input type="radio" name="preference" value="sports" class="sr-only">
                            <div class="survey-option-icon">
                                <span class="material-icons" aria-hidden="true">sports_soccer</span>
                            </div>
                            <span>Sports</span>
                        </label>
                        <label class="survey-option" data-value="radio">
                            <input type="radio" name="preference" value="radio" class="sr-only">
                            <div class="survey-option-icon">
                                <span class="material-icons" aria-hidden="true">radio</span>
                            </div>
                            <span>Radio</span>
                        </label>
                        <label class="survey-option" data-value="tv">
                            <input type="radio" name="preference" value="tv" class="sr-only">
                            <div class="survey-option-icon">
                                <span class="material-icons" aria-hidden="true">tv</span>
                            </div>
                            <span>TV en direct</span>
                        </label>
                        <label class="survey-option" data-value="meteo">
                            <input type="radio" name="preference" value="meteo" class="sr-only">
                            <div class="survey-option-icon">
                                <span class="material-icons" aria-hidden="true">cloud</span>
                            </div>
                            <span>Météo</span>
                        </label>
                    </div>
                </fieldset>
                
                <!-- Question 2 -->
                <fieldset class="survey-question" data-question="nouvelle_fonctionnalite">
                    <legend>Quelle nouvelle fonctionnalité souhaiteriez-vous voir sur le site ?</legend>
                    <div class="survey-options" role="radiogroup">
                        <label class="survey-option" data-value="agenda">
                            <input type="radio" name="nouvelle_fonctionnalite" value="agenda" class="sr-only">
                            <div class="survey-option-icon">
                                <span class="material-icons" aria-hidden="true">event</span>
                            </div>
                            <span>Agenda des événements locaux</span>
                        </label>
                        <label class="survey-option" data-value="petites_annonces">
                            <input type="radio" name="nouvelle_fonctionnalite" value="petites_annonces" class="sr-only">
                            <div class="survey-option-icon">
                                <span class="material-icons" aria-hidden="true">sell</span>
                            </div>
                            <span>Petites annonces gratuites</span>
                        </label>
                        <label class="survey-option" data-value="tribune">
                            <input type="radio" name="nouvelle_fonctionnalite" value="tribune" class="sr-only">
                            <div class="survey-option-icon">
                                <span class="material-icons" aria-hidden="true">forum</span>
                            </div>
                            <span>Tribune libre/Blog citoyen</span>
                        </label>
                        <label class="survey-option" data-value="alertes">
                            <input type="radio" name="nouvelle_fonctionnalite" value="alertes" class="sr-only">
                            <div class="survey-option-icon">
                                <span class="material-icons" aria-hidden="true">notifications_active</span>
                            </div>
                            <span>Alertes locales (travaux, urgences...)</span>
                        </label>
                        <label class="survey-option" data-value="carte">
                            <input type="radio" name="nouvelle_fonctionnalite" value="carte" class="sr-only">
                            <div class="survey-option-icon">
                                <span class="material-icons" aria-hidden="true">map</span>
                            </div>
                            <span>Carte interactive des commerces et services</span>
                        </label>
                    </div>
                </fieldset>
                
                <!-- Question 3 -->
                <fieldset class="survey-question" data-question="frequence">
                    <legend>À quelle fréquence visitez-vous Actu&Média ?</legend>
                    <div class="survey-options" role="radiogroup">
                        <label class="survey-option" data-value="quotidien">
                            <input type="radio" name="frequence" value="quotidien" class="sr-only">
                            <div class="survey-option-icon">
                                <span class="material-icons" aria-hidden="true">today</span>
                            </div>
                            <span>Tous les jours</span>
                        </label>
                        <label class="survey-option" data-value="hebdomadaire">
                            <input type="radio" name="frequence" value="hebdomadaire" class="sr-only">
                            <div class="survey-option-icon">
                                <span class="material-icons" aria-hidden="true">view_week</span>
                            </div>
                            <span>Plusieurs fois par semaine</span>
                        </label>
                        <label class="survey-option" data-value="mensuel">
                            <input type="radio" name="frequence" value="mensuel" class="sr-only">
                            <div class="survey-option-icon">
                                <span class="material-icons" aria-hidden="true">calendar_month</span>
                            </div>
                            <span>Quelques fois par mois</span>
                        </label>
                        <label class="survey-option" data-value="occasionnel">
                            <input type="radio" name="frequence" value="occasionnel" class="sr-only">
                            <div class="survey-option-icon">
                                <span class="material-icons" aria-hidden="true">calendar_today</span>
                            </div>
                            <span>Occasionnellement</span>
                        </label>
                        <label class="survey-option" data-value="premiere">
                            <input type="radio" name="frequence" value="premiere" class="sr-only">
                            <div class="survey-option-icon">
                                <span class="material-icons" aria-hidden="true">new_releases</span>
                            </div>
                            <span>C'est ma première visite</span>
                        </label>
                    </div>
                </fieldset>
                
                <button type="submit" class="survey-submit" id="surveySubmit">Envoyer mes réponses</button>
            </form>
            
            <!-- Message de remerciement et résultats -->
            <div class="thank-you-message" id="thankYouMessage" style="display: none;" role="status">
                <span class="thank-you-icon" aria-hidden="true">🎉</span>
                <h3>Merci pour votre participation !</h3>
                <p>Votre avis est précieux pour améliorer Actu&Média.</p>
                
                <div class="survey-results">
                    <h4>Résultats actuels du sondage</h4>
                    <div id="surveyResults" role="region" aria-live="polite">
                        <!-- Les résultats seront injectés ici par JavaScript -->
                    </div>
                </div>
                
                <button class="back-to-survey" id="closeSurveyAfterSubmit">Retour au site</button>
            </div>
        </div>
    </dialog>
	
	<!-- === POPUP DE DON AVEC TRANSPARENCE FINANCIÈRE === -->
    <dialog class="donation-overlay" id="donationPopup" aria-labelledby="donationTitle" aria-describedby="donationDesc">
        <div class="donation-popup">
            <button id="donationClose" class="donation-close" aria-label="Fermer la fenêtre de don">×</button>
            
            <header class="donation-header">
                <span class="donation-emoji" aria-hidden="true">🙏</span>
                <h3 id="donationTitle">Soutenez Actu & Média</h3>
            </header>
            
            <div class="donation-body" id="donationDesc">
                <p class="donation-main-text">
                    <strong>Depuis 8 mois</strong>, ce site bénévole informe gratuitement 
                    les habitants de Montceau-les-Mines.
                </p>
                
                <div class="donation-features" role="list">
                    <div class="feature" role="listitem">✅ Sans publicité</div>
                    <div class="feature" role="listitem">✅ 100% gratuit</div>
                    <div class="feature" role="listitem">✅ Indépendant</div>
                    <div class="feature" role="listitem">✅ Créé bénévolement</div>
                </div>

                <section class="financial-transparency">
                    <h4>💰 Nos frais annuels réels</h4>
                    <table class="costs-breakdown" role="table" aria-label="Détail des coûts">
                        <tbody>
                            <tr class="cost-item">
                                <td class="cost-label">Hébergement serveur</td>
                                <td class="cost-amount">120€/an</td>
                            </tr>
                            <tr class="cost-item">
                                <td class="cost-label">Nom de domaine .fr</td>
                                <td class="cost-amount">15€/an</td>
                            </tr>
                            <tr class="cost-item">
                                <td class="cost-label">Maintenance technique</td>
                                <td class="cost-amount">65€/an</td>
                            </tr>
                            <tr class="cost-total">
                                <td class="cost-label"><strong>Total annuel</strong></td>
                                <td class="cost-amount"><strong>200€</strong></td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="donation-progress" role="progressbar" aria-valuenow="5" aria-valuemin="0" aria-valuemax="200" aria-label="Progression des dons">
                        <p class="progress-label">Objectif 2025 : 200€</p>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 2.5%;">
                                <span class="progress-text">5€ / 200€</span>
                            </div>
                        </div>
                        <p class="progress-info">Collecté : <strong>5€</strong> (2.5%)</p>
                    </div>
                </section>
                
                <p class="donation-appeal">
                    Ce site est créé et maintenu <strong>bénévolement</strong> avec passion.
                    Votre soutien, même 1€, compte énormément pour couvrir les frais techniques
                    et permettre la continuité de ce service local.
                </p>

                <div class="suggested-amounts">
                    <p class="suggested-title">Montant suggéré :</p>
                    <div class="amount-buttons" role="group" aria-label="Montants suggérés">
                        <button class="amount-btn" onclick="handleAmountClick(1)" aria-label="Donner 1 euro">1€</button>
                        <button class="amount-btn" onclick="handleAmountClick(5)" aria-label="Donner 5 euros">5€</button>
                        <button class="amount-btn active" onclick="handleAmountClick(10)" aria-pressed="true" aria-label="Donner 10 euros">10€</button>
                        <button class="amount-btn" onclick="handleAmountClick(20)" aria-label="Donner 20 euros">20€</button>
                        <button class="amount-btn" onclick="handleAmountClick('other')" aria-label="Autre montant">Autre</button>
                    </div>
                </div>
            </div>
            
            <div class="donation-actions">
                <a href="https://www.paypal.com/donate/?hosted_button_id=FKJPST5LWBUGG" 
                   target="_blank" 
                   rel="noopener noreferrer"
                   class="donation-link primary"
                   onclick="trackDonationClick()"
                   aria-label="Faire un don sécurisé via PayPal">
                    <img src="images/paypal-icon.png" alt="" role="presentation" loading="lazy">
                    <span>Faire un don sécurisé</span>
                </a>
                
                <button class="donation-later" onclick="window.donationManager.hidePopup(true)">
                    Plus tard
                </button>
            </div>
            
            <footer class="donation-footer">
                <small>🔒 Paiement 100% sécurisé via PayPal</small>
                <small>📊 Transparence totale sur l'utilisation des dons</small>
            </footer>
        </div>
    </dialog>

    <!-- === MODAL DE SOUMISSION D'ACTUALITÉ === -->
    <dialog id="submitModal" class="submit-modal" aria-labelledby="submitTitle" aria-describedby="submitDesc">
        <div class="submit-modal-content">
            <header class="modal-header">
                <h2 class="modal-title" id="submitTitle">
                    <span aria-hidden="true">📝</span>
                    Proposer une actualité
                </h2>
                <button class="close-modal" onclick="closeSubmitModal()" aria-label="Fermer">×</button>
            </header>

            <form id="submitNewsForm" class="submit-form" novalidate>
                <!-- Type d'actualité -->
                <fieldset class="form-group">
                    <legend class="form-label">
                        <span aria-hidden="true">🎯</span>
                        Type d'actualité
                    </legend>
                    <div class="news-types" role="radiogroup">
                        <label class="news-type">
                            <input type="radio" name="newsType" value="actualite" checked>
                            <span>📰 Actualité</span>
                        </label>
                        <label class="news-type">
                            <input type="radio" name="newsType" value="evenement">
                            <span>🎪 Événement</span>
                        </label>
                        <label class="news-type">
                            <input type="radio" name="newsType" value="pratique">
                            <span>💡 Info pratique</span>
                        </label>
                        <label class="news-type">
                            <input type="radio" name="newsType" value="insolite">
                            <span>🤔 Insolite</span>
                        </label>
                        <label class="news-type">
                            <input type="radio" name="newsType" value="photo">
                            <span>📸 Photo/Vidéo</span>
                        </label>
                        <label class="news-type">
                            <input type="radio" name="newsType" value="autre">
                            <span>📋 Autre</span>
                        </label>
                    </div>
                </fieldset>

                <!-- Titre -->
                <div class="form-group">
                    <label class="form-label" for="newsTitle">
                        <span aria-hidden="true">📢</span>
                        Titre de l'actualité <span aria-label="requis">*</span>
                    </label>
                    <input 
                        type="text" 
                        id="newsTitle" 
                        name="title" 
                        class="form-input" 
                        placeholder="Ex: Ouverture d'un nouveau commerce..."
                        required
                        maxlength="100"
                        aria-required="true"
                        aria-describedby="titleHint"
                    >
                    <span class="form-hint" id="titleHint">Maximum 100 caractères</span>
                </div>

                <!-- Contenu -->
                <div class="form-group">
                    <label class="form-label" for="newsContent">
                        <span aria-hidden="true">📝</span>
                        Description / Contenu <span aria-label="requis">*</span>
                    </label>
                    <textarea 
                        id="newsContent" 
                        name="content" 
                        class="form-textarea" 
                        placeholder="Décrivez votre actualité, événement ou information..."
                        required
                        maxlength="1000"
                        aria-required="true"
                        aria-describedby="contentHint"
                    ></textarea>
                    <span class="form-hint" id="contentHint">Maximum 1000 caractères</span>
                </div>

                <!-- Lieu (optionnel) -->
                <div class="form-group">
                    <label class="form-label" for="newsLocation">
                        <span aria-hidden="true">📍</span>
                        Lieu (optionnel)
                    </label>
                    <input 
                        type="text" 
                        id="newsLocation" 
                        name="location" 
                        class="form-input" 
                        placeholder="Ex: Place André Malraux, Centre-ville..."
                    >
                </div>

                <!-- Date (optionnel) -->
                <div class="form-group">
                    <label class="form-label" for="newsDate">
                        <span aria-hidden="true">📅</span>
                        Date de l'événement (optionnel)
                    </label>
                    <input 
                        type="datetime-local" 
                        id="newsDate" 
                        name="eventDate" 
                        class="form-input"
                    >
                </div>

                <!-- Upload fichier -->
                <div class="form-group">
                    <label class="form-label">
                        <span aria-hidden="true">📎</span>
                        Photo ou document (optionnel)
                    </label>
                    <div class="file-upload">
                        <input 
                            type="file" 
                            id="newsFile" 
                            name="file" 
                            accept="image/*,.pdf,.doc,.docx"
                            onchange="handleFileSelect(this)"
                            aria-describedby="fileHint"
                        >
                        <label for="newsFile" class="file-upload-label" id="fileLabel">
                            <span aria-hidden="true">📎</span>
                            <span>Cliquez pour ajouter un fichier</span>
                        </label>
                    </div>
                    <span class="form-hint" id="fileHint">Images, PDF, Word - Max 5MB</span>
                </div>

                <!-- Contact -->
                <div class="form-group">
                    <label class="form-label" for="newsContact">
                        <span aria-hidden="true">📧</span>
                        Votre email (pour vous recontacter) <span aria-label="requis">*</span>
                    </label>
                    <input 
                        type="email" 
                        id="newsContact" 
                        name="contact" 
                        class="form-input" 
                        placeholder="votre.email@exemple.fr"
                        required
                        aria-required="true"
                        aria-describedby="emailHint"
                    >
                    <span class="form-hint" id="emailHint">Votre email ne sera pas publié</span>
                </div>

                <!-- Nom (optionnel) -->
                <div class="form-group">
                    <label class="form-label" for="newsAuthor">
                        <span aria-hidden="true">👤</span>
                        Votre nom/pseudo (optionnel)
                    </label>
                    <input 
                        type="text" 
                        id="newsAuthor" 
                        name="author" 
                        class="form-input" 
                        placeholder="Pour vous créditer si publié"
                    >
                </div>

                <!-- Actions -->
                <div class="form-actions">
                    <button type="button" class="btn btn-cancel" onclick="closeSubmitModal()">
                        Annuler
                    </button>
                    <button type="submit" class="btn btn-submit">
                        📤 Envoyer ma proposition
                    </button>
                </div>
            </form>

            <!-- Message de succès -->
            <div id="successMessage" class="success-message" style="display: none;" role="status" aria-live="polite">
                <div class="success-icon" aria-hidden="true">✅</div>
                <h3 class="success-title">Merci pour votre contribution !</h3>
                <div class="success-text">
                    <p>Votre proposition d'actualité a bien été envoyée à l'équipe d'Actu&Média.</p>
                    <p>Nous l'examinerons rapidement et vous recontacterons si nécessaire.</p>
                    <p><strong>Continuez à faire vivre l'actualité locale !</strong></p>
                </div>
            </div>
        </div>
    </dialog>
	
	<!-- === SCRIPTS JAVASCRIPT OPTIMISÉS === -->
    
    <!-- Scripts de gestion des modals et interactions -->
    <script>
        // Configuration de base et initialisation immédiate
        document.addEventListener('DOMContentLoaded', function() {
            // Initialisation de l'année courante
            const yearElement = document.getElementById('currentYear');
            if (yearElement) {
                yearElement.textContent = new Date().getFullYear();
            }
            
            // Configuration de la navigation accessible
            setupAccessibleNavigation();
            
            // Initialisation des observateurs de performance
            if ('IntersectionObserver' in window) {
                initLazyLoading();
            }
        });

        // Fonction pour la navigation accessible
        function setupAccessibleNavigation() {
            // Gestion du menu avec ARIA
            const menuButton = document.getElementById('menuButton');
            const sidebar = document.getElementById('sidebar');
            
            if (menuButton && sidebar) {
                menuButton.addEventListener('click', function() {
                    const isOpen = sidebar.classList.contains('open');
                    sidebar.classList.toggle('open');
                    menuButton.setAttribute('aria-expanded', !isOpen);
                    sidebar.setAttribute('aria-hidden', isOpen);
                });
            }
            
            // Fermeture au clic sur Escape
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeAllModals();
                }
            });
        }

        // Fonction pour fermer toutes les modals
        function closeAllModals() {
            const modals = document.querySelectorAll('dialog[open]');
            modals.forEach(modal => modal.close());
            document.body.style.overflow = '';
        }

        // Lazy loading pour les images
        function initLazyLoading() {
            const images = document.querySelectorAll('img[loading="lazy"]');
            const imageObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        img.src = img.dataset.src || img.src;
                        observer.unobserve(img);
                    }
                });
            });
            
            images.forEach(img => imageObserver.observe(img));
        }

        // === GESTION DU FORMULAIRE DE SOUMISSION ===
        function openSubmitModal() {
            const modal = document.getElementById('submitModal');
            if (modal) {
                modal.showModal();
                document.body.style.overflow = 'hidden';
                
                // Vibration tactile si disponible
                if ('vibrate' in navigator) {
                    navigator.vibrate(50);
                }
            }
        }

        function closeSubmitModal() {
            const modal = document.getElementById('submitModal');
            if (modal) {
                modal.close();
                document.body.style.overflow = '';
                
                // Reset du formulaire
                const form = document.getElementById('submitNewsForm');
                if (form) form.reset();
                resetFileLabel();
                hideSuccessMessage();
            }
        }

        // Gestion des types d'actualité avec accessibilité
        document.addEventListener('DOMContentLoaded', function() {
            const newsTypes = document.querySelectorAll('input[name="newsType"]');
            
            newsTypes.forEach(radio => {
                radio.addEventListener('change', function() {
                    // Mise à jour visuelle
                    document.querySelectorAll('.news-type').forEach(label => {
                        label.classList.remove('selected');
                    });
                    this.closest('.news-type').classList.add('selected');
                });
            });
        });

        // Gestion de l'upload de fichier
        function handleFileSelect(input) {
            const label = document.getElementById('fileLabel');
            const file = input.files[0];
            
            if (file) {
                // Vérification de la taille du fichier
                if (file.size > 5 * 1024 * 1024) {
                    alert('Le fichier ne doit pas dépasser 5MB');
                    input.value = '';
                    return;
                }
                
                label.innerHTML = `<span aria-hidden="true">✅</span><span>${file.name}</span>`;
                label.classList.add('file-selected');
            } else {
                resetFileLabel();
            }
        }

        function resetFileLabel() {
            const label = document.getElementById('fileLabel');
            if (label) {
                label.innerHTML = '<span aria-hidden="true">📎</span><span>Cliquez pour ajouter un fichier</span>';
                label.classList.remove('file-selected');
            }
        }

        // Soumission du formulaire avec validation
        document.getElementById('submitNewsForm')?.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = this.querySelector('.btn-submit');
            const originalText = submitBtn.innerHTML;
            
            // Validation côté client
            if (!this.checkValidity()) {
                this.reportValidity();
                return;
            }
            
            // Désactiver le bouton et afficher loading
            submitBtn.disabled = true;
            submitBtn.innerHTML = '⏳ Envoi en cours...';
            submitBtn.setAttribute('aria-busy', 'true');
            
            try {
                const formData = new FormData(this);
                
                // Envoi via Formspree
                await sendNewsSubmission(formData);
                
                // Afficher le message de succès
                showSuccessMessage();
                
            } catch (error) {
                console.error('Erreur envoi:', error);
                alert('Erreur lors de l\'envoi. Réessayez ou contactez-nous directement.');
                
                // Restaurer le bouton
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalText;
                submitBtn.setAttribute('aria-busy', 'false');
            }
        });

        // Fonction d'envoi optimisée
        async function sendNewsSubmission(formData) {
            try {
                const response = await fetch('https://formspree.io/f/xpwrjqjw', {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'Accept': 'application/json'
                    }
                });

                if (!response.ok) {
                    throw new Error(`Erreur HTTP: ${response.status}`);
                }

                const result = await response.json();
                console.log('✅ Email envoyé via Formspree:', result);
                
            } catch (error) {
                console.error('❌ Erreur Formspree:', error);
                throw error;
            }
        }

        function showSuccessMessage() {
            const form = document.getElementById('submitNewsForm');
            const successMsg = document.getElementById('successMessage');
            
            if (form && successMsg) {
                form.style.display = 'none';
                successMsg.style.display = 'block';
                
                // Fermer automatiquement après 5 secondes
                setTimeout(() => {
                    closeSubmitModal();
                }, 5000);
            }
        }

        function hideSuccessMessage() {
            const form = document.getElementById('submitNewsForm');
            const successMsg = document.getElementById('successMessage');
            
            if (form && successMsg) {
                form.style.display = 'flex';
                successMsg.style.display = 'none';
            }
        }

        // === GESTION DES DONATIONS ===
        function handleAmountClick(amount) {
            // Retirer la classe active de tous les boutons
            document.querySelectorAll('.amount-btn').forEach(btn => {
                btn.classList.remove('active');
                btn.setAttribute('aria-pressed', 'false');
            });
            
            // Ajouter la classe active au bouton cliqué
            if (event && event.target) {
                event.target.classList.add('active');
                event.target.setAttribute('aria-pressed', 'true');
            }
            
            // Vibration tactile si disponible
            if ('vibrate' in navigator) {
                navigator.vibrate(50);
            }
            
            console.log('Montant sélectionné:', amount + '€');
        }

        function trackDonationClick() {
            // Analytics ou tracking
            if (typeof gtag !== 'undefined') {
                gtag('event', 'click', {
                    'event_category': 'donation',
                    'event_label': 'paypal'
                });
            }
            
            // Fermer la popup après un délai
            setTimeout(() => {
                if (window.donationManager) {
                    window.donationManager.hidePopup(false);
                }
            }, 1000);
        }

        function updateDonationProgress(collected, goal) {
            const percentage = Math.min((collected / goal) * 100, 100);
            const progressFill = document.querySelector('.progress-fill');
            const progressText = document.querySelector('.progress-text');
            const progressInfo = document.querySelector('.progress-info');
            
            if (progressFill) {
                progressFill.style.width = Math.max(percentage, 2.5) + '%';
                progressText.textContent = `${collected}€ / ${goal}€`;
                progressInfo.innerHTML = `Collecté : <strong>${collected}€</strong> (${percentage.toFixed(1)}%)`;
                
                // Mise à jour ARIA
                const progressBar = document.querySelector('.donation-progress');
                if (progressBar) {
                    progressBar.setAttribute('aria-valuenow', collected);
                }
            }
        }

        // === OPTIMISATION PERFORMANCE ===
        // Service Worker pour PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => console.log('SW registered:', registration))
                    .catch(error => console.log('SW registration failed:', error));
            });
        }

        // Gestion du mode offline
        window.addEventListener('online', () => {
            console.log('Connexion rétablie');
            // Recharger les données si nécessaire
        });

        window.addEventListener('offline', () => {
            console.log('Mode hors ligne');
            // Afficher un message à l'utilisateur
        });
    </script>

    <!-- === SCRIPTS EXTERNES AVEC DEFER === -->
    <script src="js/
	*.js" defer></script>
    <script src="js/ios-install.js" defer></script>
    <script src="js/ban-manager.js" defer></script>
    <script src="js/welcome-manager.js" defer></script>
    <script src="js/expense-manager.js" defer></script>
    <script src="js/news-manager.js" defer></script>
    <script src="js/newsTickerManager.js" defer></script>
    <script src="js/newsPanel.js" defer></script>
    <script src="js/weather-widget.js" defer></script>
    <script src="js/quick-links.js" defer></script>
    <script src="js/tablet-fixes.js" defer></script>
    <script src="js/chat-keyboard-fix.js" defer></script>
    <script src="js/ban-check.js" defer></script>
    <script src="js/theme-manager.js" defer></script>
    <script src="js/donation.js" defer></script>
    <script src="js/survey-manager.js" defer></script>
    <script src="js/news-widget.js" defer></script>
    <script src="js/cinema-widget.js" defer></script>
    <script src="js/visitor-tracker.js" defer></script>
    <script src="js/football-widget.js" defer></script>
    <script src="js/radioPopup.js" defer></script>
    <script src="js/notepadApp.js" defer></script>
    <script src="js/todoApp.js" defer></script>
    <script src="js/background-selector.js" defer></script>
    <script src="js/custom-background-manager.js" defer></script>
	<script src="js/gallery-manager-v2.js" defer></script>
	<script src="js/chatManager.js" defer></script>
	<script src="js/ios-fixes-safe.js" defer></script>
	<script src="js/notification-manager.js" defer></script>
	<script src="js/settingsManager.js" defer></script>
	<script src="js/sounds.js" defer></script>
	<script src="js/utils.js" defer></script>
    
    <!-- Script d'initialisation principal (module) -->
    <script type="module" src="js/app-initializer.js"></script>
    
    <!-- Chart.js pour les graphiques (chargement différé) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>

</body>
</html>
	
	