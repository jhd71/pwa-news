<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Notifications Actu&Média</title>
  <style>
    body { font-family: sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; }
    h1 { color: #6e46c9; }
    .form-group { margin-bottom: 15px; }
    label { display: block; margin-bottom: 5px; font-weight: bold; }
    input, textarea { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
    button { background: #6e46c9; color: white; border: none; padding: 10px 15px; border-radius: 4px; cursor: pointer; }
    .result { margin-top: 20px; padding: 10px; border-radius: 4px; }
    .success { background: #e6f7e6; border: 1px solid #2e7d32; }
    .error { background: #fdecea; border: 1px solid #d32f2f; }
    .hidden { display: none; }
    .checkbox { display: flex; align-items: center; }
    .checkbox input { width: auto; margin-right: 8px; }
  </style>
</head>
<body>
  <h1>Envoyer une notification</h1>
  
  <form id="notification-form">
    <div class="form-group">
      <label for="title">Titre*</label>
      <input type="text" id="title" required>
    </div>
    
    <div class="form-group">
      <label for="body">Message*</label>
      <textarea id="body" required rows="4"></textarea>
    </div>
    
    <div class="form-group checkbox">
      <input type="checkbox" id="urgent">
      <label for="urgent">Notification urgente</label>
    </div>
    
    <button type="submit">Envoyer la notification</button>
  </form>
  
  <div id="success" class="result success hidden"></div>
  <div id="error" class="result error hidden"></div>
  
  <script>
    document.getElementById('notification-form').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const title = document.getElementById('title').value.trim();
      const body = document.getElementById('body').value.trim();
      const urgent = document.getElementById('urgent').checked;
      
      if (!title || !body) {
        showError('Le titre et le message sont obligatoires');
        return;
      }
      
      // Utiliser votre API existante
      fetch('/api/send-notification', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          title,
          body,
          sendToAll: true,
          data: {
            urgent,
            type: 'important'
          }
        })
      })
      .then(response => response.json())
      .then(data => {
        if (data.success) {
          showSuccess(`Notification envoyée avec succès à ${data.sent} destinataires`);
          document.getElementById('notification-form').reset();
        } else {
          showError(`Erreur: ${data.error || 'Échec de l\'envoi'}`);
        }
      })
      .catch(error => {
        showError('Erreur de connexion');
        console.error(error);
      });
    });
    
    function showSuccess(message) {
      const success = document.getElementById('success');
      success.textContent = message;
      success.classList.remove('hidden');
      document.getElementById('error').classList.add('hidden');
    }
    
    function showError(message) {
      const error = document.getElementById('error');
      error.textContent = message;
      error.classList.remove('hidden');
      document.getElementById('success').classList.add('hidden');
    }
  </script>
</body>
</html>