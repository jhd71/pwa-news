<!DOCTYPE html>
<html lang="fr" data-theme="rouge" data-font-size="normal">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Actu&Média</title>
    
    <!-- Styles de base -->
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/theme-bleuciel.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <!-- Styles iOS pour les corrections essentielles -->
    <style>
        /* Styles iOS de base */
        :root {
            --safe-area-top: env(safe-area-inset-top, 0px);
            --safe-area-bottom: env(safe-area-inset-bottom, 0px);
        }
        
        /* Correction pour le corps de la page */
        body {
            padding-top: var(--safe-area-top);
            padding-bottom: var(--safe-area-bottom);
            -webkit-overflow-scrolling: touch;
        }
        
        /* Correction pour la barre du bas */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            padding-bottom: var(--safe-area-bottom);
            z-index: 1000;
        }
        
        /* Correction pour la barre de défilement d'infos */
        .news-ticker {
            position: fixed;
            bottom: 60px;
            left: 0;
            right: 0;
            z-index: 900;
        }
        
        /* Correction pour le contenu principal */
        main {
            margin-top: 80px; /* Espace pour l'en-tête */
            margin-bottom: 110px; /* Espace pour le ticker et la nav */
            padding-left: 10px;
            padding-right: 10px;
        }
    </style>
</head>
<body>
    <header class="app-header">
        <button type="button" id="menuButton" class="menu-button" aria-label="Menu">
            <span class="material-icons">menu</span>
        </button>
        <h1 class="site-title">
            <img src="images/Actu&Media.png" alt="Actu & Média" class="site-logo">
        </h1>
        <button type="button" id="settingsButton" class="settings-button" aria-label="Paramètres">
            <span class="material-icons">settings</span>
        </button>
    </header>

    <!-- Bouton Infos en direct -->
    <div class="button-group" style="margin-top: 15px; text-align: center;">
        <button id="newsButton" class="news-button">
            <span class="material-icons">feed</span>
            <span>Infos en direct</span>
        </button>
    </div>

    <!-- Conteneur principal des tuiles -->
    <main>
        <div id="tileContainer" class="tile-container grid"></div>
    </main>

    <!-- Ticker d'actualités -->
    <div class="news-ticker">
        <div class="ticker-wrapper" id="newsTicker">
            <div class="ticker-item">Chargement des actualités...</div>
        </div>
    </div>

    <!-- Barre de navigation du bas -->
    <nav class="bottom-nav">
        <button class="nav-item" id="darkModeToggle">
            <span class="material-icons">dark_mode</span>
            <span>Rouge</span>
        </button>
        <button class="nav-item" id="addSiteBtn">
            <span class="material-icons">add_circle</span>
            <span>Ajouter</span>
        </button>
        <button class="nav-item" id="layoutToggle">
            <span class="material-icons">grid_view</span>
            <span>Vue</span>
        </button>
        <button class="nav-item" id="donateBtn">
            <span class="material-icons">volunteer_activism</span>
            <span>Soutenir</span>
        </button>
        <button class="nav-item" id="surveyBtn">
            <span class="material-icons">poll</span>
            <span>Sondage</span>
        </button>
        <button class="nav-item" id="chatToggleBtn">
            <span class="material-icons">chat</span>
            <span>Chat</span>
        </button>
    </nav>

    <!-- Scripts minimaux - utilisez les originaux sans iOS -->
    <!-- À la fin du body, juste avant </body> -->
<script src="js/app.js" type="module"></script>
<script src="js/welcome-manager.js"></script>
<script src="js/news-manager.js"></script>
<script src="js/newsTickerManager.js"></script>
<script src="js/newsPanel.js"></script>
<script src="js/weather-widget.js"></script>
<script src="js/quick-links.js"></script>
<script src="js/ban-check.js"></script>
<script src="js/theme-manager.js"></script>
<script src="js/donation.js"></script>
<script src="js/survey-manager.js"></script>
<script src="js/background-selector.js"></script>

<!-- Script iOS minimaliste pour ajustements -->
<script>
    // Ajustements iOS minimaux
    document.addEventListener('DOMContentLoaded', function() {
        // Ajouter des classes iOS
        document.documentElement.classList.add('ios');
        document.body.classList.add('ios-body');
        
        // Ajuster la hauteur de la vue
        const setIOSHeight = () => {
            const vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
        };
        
        setIOSHeight();
        window.addEventListener('resize', setIOSHeight);
        window.addEventListener('orientationchange', () => {
            setTimeout(setIOSHeight, 100);
        });
        
        // Ajuster les positions fixes pour iOS
        const ticker = document.querySelector('.news-ticker');
        if (ticker) {
            ticker.style.bottom = 'calc(60px + env(safe-area-inset-bottom, 0px))';
        }
        
        const nav = document.querySelector('.bottom-nav');
        if (nav) {
            nav.style.paddingBottom = 'env(safe-area-inset-bottom, 0px)';
        }
        
        // Améliorer le défilement
        document.querySelectorAll('.tile-container, .news-panel, .sidebar').forEach(el => {
            el.style.webkitOverflowScrolling = 'touch';
        });
    });
</script>
</body>
</html>